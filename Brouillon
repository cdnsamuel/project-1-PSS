#Supprimer une entrée a folder.list
{
    echo "Veuillez entrer le chemin du répertoire à supprimer de la sauvegarde :"
    read directory
    if grep -Fxq "$directory" "$directories_file"; then
        grep -vFx "$directory" "$directories_file" > "$directories_file.tmp" && mv "$directories_file.tmp" "$directories_file"
        echo "Répertoire supprimé avec succès."
    else
        echo "Erreur : Le répertoire n'est pas dans la liste de sauvegarde."
    fi
}

# Fonction pour lancer la sauvegarde maintenant
launch_backup(){
    if [ -z "$backup_location" ]; then
        echo "Erreur : Veuillez définir l'emplacement de sauvegarde avant de lancer la sauvegarde."
        return
    fi

    timestamp=$(date +"%Y_%m_%d_%H_%M_%S")
    backup_folder="$backup_prefix"_"$timestamp"
    backup_path="$backup_location/$backup_folder"

    mkdir -p "$backup_path"
    while IFS= read -r directory; do
        cp -r "$directory" "$backup_path"
    done < "$directories_file"

    echo "Sauvegarde terminée. Le dossier de sauvegarde est : $backup_path"
}

# Changer la planification
edit_cron() {
    echo "Veuillez spécifier la fréquence des sauvegardes (daily/weekly) :"
    read frequency

    if [ "$frequency" != "daily" ] && [ "$frequency" != "weekly" ]; then
        echo "Erreur : Fréquence invalide. Choisissez 'daily' ou 'weekly'."
        return
    fi

    echo "Veuillez spécifier l'heure de la sauvegarde (format 24 heures, ex. 02:30) :"
    read cron_time

    cron_command="$cron_time * *"
    if [ "$frequency" == "daily" ]; then
        cron_command="$cron_command *"
    elif [ "$frequency" == "weekly" ]; then
        echo "Veuillez spécifier le jour de la semaine pour la sauvegarde (0-6, où 0=dimanche, 1=lundi, ..., 6=samedi) :"
        read day_of_week
        cron_command="$cron_command $day_of_week"
    fi

    (crontab -l ; echo "$cron_command $0 backup_now") | crontab -
    echo "Tâche cron ajoutée avec succès."
}
